<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KenariCoin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" type="image/png" href="img/logo.png">
  <!-- Ethers.js -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

  <style>
    .page-section {
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.4s ease, transform 0.4s ease;
      display: none;
    }
    .page-section.active {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }
    .glow-hover:hover {
      box-shadow: 0 0 12px rgba(250, 204, 21, 0.7);
      transition: box-shadow 0.3s ease;
    }
  </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen flex flex-col">

  <!-- Navbar -->
<nav class="bg-gray-800 shadow fixed w-full z-20 top-0 border-b border-gray-700">
  <div class="max-w-7xl mx-auto px-4 flex justify-between items-center h-16">
    <!-- Kiri: Logo + Nama -->
    <div class="flex items-center space-x-2">
      <button id="menuBtn" class="md:hidden mr-2 p-2 rounded hover:bg-gray-700" aria-label="Open menu" onclick="toggleMenu()">
        ‚ò∞
      </button>
      <img src="img/logo.png" alt="Logo" class="w-10 h-10 rounded-full">
      <span class="font-bold text-lg text-yellow-400">KenariCoin</span>
    </div>

    <!-- Tengah: Link navigasi -->
    <div id="navLinks" class="hidden md:flex space-x-6">
      <a href="#" onclick="navigate('home')" class="hover:text-yellow-400">Home</a>
      <a href="#" onclick="navigate('wallet')" class="hover:text-yellow-400">Wallet</a>
      <a href="#" onclick="navigate('staking')" class="hover:text-yellow-400">Staking</a>
      <a href="#" onclick="navigate('about')" class="hover:text-yellow-400">About</a>
      <a href="#" onclick="navigate('contact')" class="hover:text-yellow-400">Contact</a>
      <a href="#" onclick="navigate('faq')" class="hover:text-yellow-400">FAQ</a>
    </div>

    <!-- Kanan: Switcher + Connect Wallet -->
    <div class="flex items-center space-x-2">
      <select id="networkSwitcher" onchange="switchNetwork(this.value)" 
        class="px-2 py-1 rounded bg-gray-700 text-yellow-400 text-sm">
        <option value="mainnet">Mainnet</option>
        <option value="testnet">Testnet</option>
      </select>

      <button id="connectBtn" onclick="openModal()" 
        class="px-3 py-1.5 bg-yellow-500 text-black rounded-lg font-semibold hover:bg-yellow-400 shadow glow-hover text-sm">
        Connect
      </button>
    </div>
  </div>
</nav>
    <!-- Mobile menu -->
    <div id="mobileMenu" class="md:hidden hidden border-t border-gray-700 bg-gray-800 px-4 py-3 space-y-2">
      <a href="#" onclick="navigate('home'); toggleMenu(false)" class="block hover:text-yellow-400">Home</a>
      <a href="#" onclick="navigate('wallet'); toggleMenu(false)" class="block hover:text-yellow-400">Wallet</a>
      <a href="#" onclick="navigate('staking'); toggleMenu(false)" class="block hover:text-yellow-400">Staking</a>
      <a href="#" onclick="navigate('about'); toggleMenu(false)" class="block hover:text-yellow-400">About</a>
      <a href="#" onclick="navigate('contact'); toggleMenu(false)" class="block hover:text-yellow-400">Contact</a>
      <a href="#" onclick="navigate('faq'); toggleMenu(false)" class="block hover:text-yellow-400">FAQ</a>
    </div>
  </nav>

  <!-- Pages -->
  <main class="flex-grow px-4 pt-24 pb-10">

    <!-- Home -->
    <section id="home" class="page-section text-center active">
      <img src="img/logo.png" alt="KenariCoin Logo" class="w-32 h-32 rounded-full mx-auto shadow-lg border border-yellow-400 glow-hover">
      <h1 class="text-3xl font-bold mt-4 text-yellow-400">Selamat Datang di KenariCoin</h1>
      <div class="mt-6 max-w-xl mx-auto bg-gray-800 shadow rounded-xl p-4 text-gray-300 glow-hover">
        <h3 class="font-bold mb-2">üìú Contract Address</h3>
        <div class="flex items-center justify-between">
          <span id="contractAddr" class="text-sm break-all">0x1390f63AF92448c46368443496a2bfc1469558de</span>
          <button onclick="copyContract()" class="ml-2 px-3 py-1 bg-yellow-500 text-black rounded-lg text-sm hover:bg-yellow-400 glow-hover">
            Copy
          </button>
        </div>
      </div>
    </section>

    <!-- Wallet -->
    <section id="wallet" class="page-section max-w-md mx-auto text-center">
      <h2 class="text-2xl font-bold mb-4 text-yellow-400">Wallet Balance</h2>
      <div class="bg-gray-800 rounded-xl shadow p-6 text-left glow-hover">
        <p>BNB: <span id="bnbBalance">0 BNB</span></p>
        <p>KN: <span id="tokenBalance">0 KN</span></p>
      </div>
    </section>

    <!-- Staking -->
    <section id="staking" class="page-section max-w-md mx-auto text-center">
      <h2 class="text-2xl font-bold mb-4 text-yellow-400">Staking KN</h2>
      <div class="bg-gray-800 rounded-xl shadow p-6 glow-hover">
        <label class="block mb-2 font-semibold">Jumlah KN untuk Staking</label>
        <input type="number" id="stakeAmount" placeholder="0.0"
               class="w-full p-3 border border-gray-600 rounded-xl mb-4 bg-gray-900 text-white">
        <button onclick="doStake()" class="w-full py-3 bg-purple-600 text-white font-bold rounded-xl hover:bg-purple-500 glow-hover mb-2">
          Stake
        </button>
        <button onclick="doWithdraw()" class="w-full py-3 bg-red-600 text-white font-bold rounded-xl hover:bg-red-500 glow-hover">
          Withdraw
        </button>
        <p class="mt-4">Total Staked: <span id="totalStaked">0 KN</span></p>
        <p class="mt-2">Pending Reward: <span id="pendingReward">0 KN</span></p>
        <button onclick="claimReward()" class="w-full mt-3 py-3 bg-green-600 text-white font-bold rounded-xl hover:bg-green-500 glow-hover">
          Claim Reward
        </button>
      </div>

      <div class="bg-gray-800 rounded-xl shadow p-6 mt-6 glow-hover">
        <h3 class="text-lg font-bold mb-3 text-yellow-400">Faucet</h3>
        <p class="text-gray-300 mb-3">Dapatkan token KN gratis untuk uji coba.</p>
        <button onclick="claimFaucet()" class="w-full py-3 bg-yellow-500 text-black font-bold rounded-xl hover:bg-yellow-400 glow-hover">
          Claim Faucet
        </button>
      </div>
    </section>

    <!-- About -->
    <section id="about" class="page-section max-w-2xl mx-auto text-center">
      <h2 class="text-2xl font-bold mb-4 text-yellow-400">Tentang KenariCoin</h2>
      <p class="text-gray-300 leading-relaxed">
        KenariCoin (KN) adalah token BEP-20 di BNB Smart Chain yang dirancang untuk ekosistem DeFi.
      </p>
    </section>

    <!-- Contact -->
    <section id="contact" class="page-section max-w-2xl mx-auto text-center">
      <h2 class="text-2xl font-bold mb-4 text-yellow-400">Contact</h2>
      <p>üìß Email: <a href="mailto:kenaricoinkn@gmail.com" class="text-yellow-400 font-semibold hover:underline">kenaricoinkn@gmail.com</a></p>
      <p>üì± Telegram: <a href="https://t.me/KenariCoinKnc" target="_blank" class="text-yellow-400 font-semibold hover:underline">Join Telegram</a></p>
    </section>

    <!-- FAQ -->
    <section id="faq" class="page-section max-w-2xl mx-auto text-center">
      <h2 class="text-2xl font-bold mb-4 text-yellow-400">FAQ (Pertanyaan Umum)</h2>
      <div class="space-y-4 text-gray-300 text-left">
        <div class="bg-gray-800 p-4 shadow rounded-xl glow-hover">
          <h3 class="font-semibold">‚ùì Apa itu KenariCoin?</h3>
          <p>KenariCoin adalah token BEP-20 berbasis Binance Smart Chain dengan fokus pada utilitas nyata dan ekosistem DeFi.</p>
        </div>
        <div class="bg-gray-800 p-4 shadow rounded-xl glow-hover">
          <h3 class="font-semibold">‚ùì Bagaimana cara mendapatkan KN?</h3>
          <p>Kamu bisa mendapatkan KN melalui faucet, airdrop komunitas, atau listing DEX di masa depan.</p>
        </div>
        <div class="bg-gray-800 p-4 shadow rounded-xl glow-hover">
          <h3 class="font-semibold">‚ùì Apakah ada fitur staking?</h3>
          <p>Ya, fitur staking dengan reward APY sudah tersedia di dashboard ini.</p>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-800 border-t border-gray-700 py-4">
    <div class="max-w-7xl mx-auto px-4 flex flex-col md:flex-row items-center justify-between text-gray-400 text-sm">
      <p>¬© 2025 KenariCoin. All rights reserved.</p>
      <div class="flex space-x-4 mt-2 md:mt-0">
        <a href="#" onclick="navigate('home')" class="hover:text-yellow-400">Home</a>
        <a href="#" onclick="navigate('wallet')" class="hover:text-yellow-400">Wallet</a>
        <a href="#" onclick="navigate('faq')" class="hover:text-yellow-400">FAQ</a>
      </div>
    </div>
  </footer>

  <!-- Wallet Modal -->
  <div id="walletModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-50">
    <div class="bg-gray-800 rounded-2xl p-6 w-80 shadow-lg text-gray-100 glow-hover">
      <h2 class="text-lg font-bold mb-4 text-center">Connect Wallet</h2>
      <div class="space-y-3">
        <button onclick="selectWallet('metamask')" class="w-full border border-gray-600 rounded-lg py-2 hover:bg-gray-700 glow-hover">ü¶ä MetaMask</button>
        <button onclick="selectWallet('okx')" class="w-full border border-gray-600 rounded-lg py-2 hover:bg-gray-700 glow-hover">‚ö´ OKX Wallet</button>
      </div>
      <button onclick="closeModal()" class="w-full mt-3 py-2 border border-gray-600 rounded-lg hover:bg-gray-700 glow-hover">Cancel</button>
    </div>
  </div>

  <!-- Script gabungan -->
  <script>
    // ----------------------------
    // UI & Navigasi
    // ----------------------------
    function showPage(pageId) {
      document.querySelectorAll(".page-section").forEach(sec => sec.classList.remove("active"));
      const el = document.getElementById(pageId);
      if (el) el.classList.add("active");
    }
    function navigate(pageId) {
      showPage(pageId);
      closeModal(); // auto tutup modal
      toggleMenu(false); // tutup mobile nav kalau kebuka
      // optional: update URL hash
      if (pageId) history.replaceState(null, "", "#" + pageId);
    }
    function toggleMenu(force) {
      const mm = document.getElementById("mobileMenu");
      if (!mm) return;
      if (typeof force === "boolean") {
        mm.classList.toggle("hidden", !force ? true : false);
        return;
      }
      mm.classList.toggle("hidden");
    }
    function openModal(){ document.getElementById("walletModal").classList.remove("hidden"); }
    function closeModal(){ document.getElementById("walletModal").classList.add("hidden"); }
    function copyContract(){
      const addr = document.getElementById("contractAddr")?.innerText;
      if(addr){ navigator.clipboard.writeText(addr); alert("‚úÖ Contract Address disalin: " + addr); }
    }
    // buka halaman dari hash jika ada
    window.addEventListener("DOMContentLoaded", () => {
      const hash = location.hash?.replace("#","") || "home";
      showPage(hash);
      // samakan address di home dgn konstanta
      document.getElementById("contractAddr").innerText = KN;
    });

    // ----------------------------
    // Blockchain constants
    // ----------------------------
    // ----------------------------
// Blockchain constants (default mainnet)
// ----------------------------
let KN = "0x1390f63AF92448c46368443496a2bfc1469558de";   // token mainnet
let STAKING_CONTRACT = "0xYourStakingMainnet";          // ganti sendiri
let FAUCET_CONTRACT  = "0xYourFaucetMainnet";           // ganti sendiri
let BSC_CHAIN_ID = "0x38"; // Mainnet

function switchNetwork(mode) {
  if (mode === "testnet") {
    KN = "0xaD3Ce803305615C73CfEB2239254501738FD91b8";   // token testnet
    STAKING_CONTRACT = "0xD9f344e8082c374A10e833fd4AA9fA2209eaE1a5";           // ganti sendiri
    FAUCET_CONTRACT  = "0x261b3d34833C1Fc3253A036E8271528439f3310d";            // ganti sendiri
    BSC_CHAIN_ID = "0x61"; // BSC Testnet
  } else {
    KN = "0x1390f63AF92448c46368443496a2bfc1469558de";   // token mainnet
    STAKING_CONTRACT = "0xYourStakingMainnet";           // ganti sendiri
    FAUCET_CONTRACT  = "0xYourFaucetMainnet";            // ganti sendiri
    BSC_CHAIN_ID = "0x38"; // Mainnet
  }

  // update tampilan di home
  document.getElementById("contractAddr").innerText = KN;

  // refresh balance kalau wallet udah connect
  if (userAddress) {
    updateBalances();
    updateStaked();
    updateReward();
  }
}

    const ERC20_ABI = [
      "function balanceOf(address) view returns (uint256)",
      "function decimals() view returns (uint8)",
      "function approve(address spender, uint256 amount) returns (bool)"
    ];
    const STAKING_ABI = [
      "function stake(uint256 amount) external",
      "function withdraw(uint256 amount) external",
      "function claimReward() external",
      "function pendingReward(address user) view returns (uint256)",
      "function getStaked(address user) view returns (uint256)"
    ];
    const FAUCET_ABI = ["function faucet() external"];

    let provider, signer, userAddress;

    function fromWei(bn, decimals){ return ethers.utils.formatUnits(bn, decimals); }

    async function ensureBSC(){
      if (!window.ethereum) return;
      const chainId = await window.ethereum.request({ method: "eth_chainId" });
      if (chainId !== BSC_CHAIN_ID) {
        await window.ethereum.request({ method: "wallet_switchEthereumChain", params:[{ chainId: BSC_CHAIN_ID }] });
      }
    }

    async function connectMetaMask(){
      if (!window.ethereum) return alert("MetaMask belum terpasang!");
      try {
        await ensureBSC();
        provider = new ethers.providers.Web3Provider(window.ethereum);
        await provider.send("eth_requestAccounts", []);
        signer = provider.getSigner();
        userAddress = await signer.getAddress();
        document.getElementById("connectBtn").innerText = userAddress.substring(0,6) + "..." + userAddress.slice(-4);
        await updateBalances(); await updateStaked(); await updateReward();
        closeModal();
      } catch(err){ alert("Gagal connect: " + (err?.data?.message || err.message)); }
    }

    async function connectOKX(){
      if (!(window.okxwallet && window.okxwallet.request)) return alert("OKX Wallet belum terpasang!");
      try {
        provider = new ethers.providers.Web3Provider(window.okxwallet);
        await provider.send("eth_requestAccounts", []);
        signer = provider.getSigner();
        userAddress = await signer.getAddress();
        document.getElementById("connectBtn").innerText = userAddress.substring(0,6) + "..." + userAddress.slice(-4);
        await updateBalances(); await updateStaked(); await updateReward();
        closeModal();
      } catch(err){ alert("Gagal connect: " + (err?.data?.message || err.message)); }
    }

    function selectWallet(w){ if (w === "metamask") connectMetaMask(); else if (w === "okx") connectOKX(); }

    async function updateBalances(){
      if (!provider || !userAddress) return;
      const bnbBal = await provider.getBalance(userAddress);
      document.getElementById("bnbBalance").innerText = (+fromWei(bnbBal, 18)).toFixed(4) + " BNB";
      const token = new ethers.Contract(KN, ERC20_ABI, provider);
      const raw = await token.balanceOf(userAddress);
      const decimals = await token.decimals();
      const kn = fromWei(raw, decimals);
      document.getElementById("tokenBalance").innerText = (+kn).toFixed(2) + " KN";
    }

    // ----------------------------
    // Staking
    // ----------------------------
    async function doStake() {
      if (!signer) return alert("Hubungkan wallet dulu!");
      const amount = parseFloat(document.getElementById("stakeAmount").value);
      if (isNaN(amount) || amount <= 0) return alert("Masukkan jumlah KN valid.");

      try {
        const token = new ethers.Contract(KN, ERC20_ABI, signer);
        const decimals = await token.decimals();
        const parsed = ethers.utils.parseUnits(amount.toString(), decimals);

        let tx = await token.approve(STAKING_CONTRACT, parsed);
        await tx.wait();

        const staking = new ethers.Contract(STAKING_CONTRACT, STAKING_ABI, signer);
        tx = await staking.stake(parsed);
        await tx.wait();

        alert(`‚úÖ Berhasil staking ${amount} KN!`);
        document.getElementById("stakeAmount").value = "";
        await updateBalances(); await updateStaked(); await updateReward();
      } catch (err) { alert("‚ùå Gagal staking: " + (err?.data?.message || err.message)); }
    }

    async function doWithdraw() {
      if (!signer) return alert("Hubungkan wallet dulu!");
      const amount = prompt("Masukkan jumlah KN untuk withdraw:");
      if (!amount) return;
      try {
        const staking = new ethers.Contract(STAKING_CONTRACT, STAKING_ABI, signer);
        const token = new ethers.Contract(KN, ERC20_ABI, signer);
        const decimals = await token.decimals();
        const parsed = ethers.utils.parseUnits(amount.toString(), decimals);

        const tx = await staking.withdraw(parsed);
        await tx.wait();

        alert(`‚úÖ Berhasil withdraw ${amount} KN!`);
        await updateBalances(); await updateStaked(); await updateReward();
      } catch (err) { alert("‚ùå Gagal withdraw: " + (err?.data?.message || err.message)); }
    }

    async function claimReward() {
      if (!signer) return alert("Hubungkan wallet dulu!");
      try {
        const staking = new ethers.Contract(STAKING_CONTRACT, STAKING_ABI, signer);
        const tx = await staking.claimReward();
        await tx.wait();
        alert("üéâ Reward berhasil diclaim!");
        await updateBalances(); await updateStaked(); await updateReward();
      } catch (err) { alert("‚ùå Claim gagal: " + (err?.data?.message || err.message)); }
    }

    async function updateStaked() {
      if (!provider || !userAddress) return;
      const staking = new ethers.Contract(STAKING_CONTRACT, STAKING_ABI, provider);
      const token = new ethers.Contract(KN, ERC20_ABI, provider);
      const decimals = await token.decimals();
      const bal = await staking.getStaked(userAddress);
      document.getElementById("totalStaked").innerText = ethers.utils.formatUnits(bal, decimals) + " KN";
    }

    async function updateReward() {
      if (!provider || !userAddress) return;
      const staking = new ethers.Contract(STAKING_CONTRACT, STAKING_ABI, provider);
      const token = new ethers.Contract(KN, ERC20_ABI, provider);
      const decimals = await token.decimals();
      const reward = await staking.pendingReward(userAddress);
      document.getElementById("pendingReward").innerText = ethers.utils.formatUnits(reward, decimals) + " KN";
    }

    // ----------------------------
    // Faucet
    // ----------------------------
    async function claimFaucet() {
      if (!signer) return alert("Hubungkan wallet dulu!");
      try {
        const faucet = new ethers.Contract(FAUCET_CONTRACT, ["function faucet() external"], signer);
        const tx = await faucet.faucet();
        await tx.wait();
        alert("üéâ Faucet berhasil! Token KN ditambahkan ke wallet Anda.");
        await updateBalances();
      } catch (err) {
        alert("‚ùå Gagal claim faucet: " + (err?.data?.message || err.message));
      }
    }

    // ----------------------------
    // Expose & Wallet events
    // ----------------------------
    window.openModal = openModal;
    window.closeModal = closeModal;
    window.navigate = navigate;
    window.selectWallet = selectWallet;
    window.copyContract = copyContract;
    window.doStake = doStake;
    window.doWithdraw = doWithdraw;
    window.claimFaucet = claimFaucet;
    window.claimReward = claimReward;
    window.toggleMenu = toggleMenu;

    if (window.ethereum) {
      window.ethereum.on('accountsChanged', async (accs) => {
        if (!accs || accs.length === 0) return;
        provider = new ethers.providers.Web3Provider(window.ethereum);
        signer = provider.getSigner();
        userAddress = accs[0];
        document.getElementById("connectBtn").innerText = userAddress.substring(0,6) + "..." + userAddress.slice(-4);
        await updateBalances(); await updateStaked(); await updateReward();
      });
      window.ethereum.on('chainChanged', () => {
        location.reload();
      });
    }
  </script>
</body>
</html>
